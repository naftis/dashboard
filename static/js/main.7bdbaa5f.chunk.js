(this["webpackJsonpkaleva-dashboard"]=this["webpackJsonpkaleva-dashboard"]||[]).push([[0],{66:function(e,t,n){},80:function(e,t,n){},89:function(e,t,n){"use strict";n.r(t);var r=n(7),a=n(3),c=n.n(a),s=n(54),i=n.n(s),o=(n(66),n(25)),u=n(28),d=n(55),l=n(22),p=n(9),j=n.n(p),h=n(15),b=(n(56),n(57)),f="https://api.openweathermap.org/data/2.5/",m={appid:"2b0ad50b08d453642b2296fd8d877fee",lang:"fi",units:"metric"};function v(e,t){return O.apply(this,arguments)}function O(){return(O=Object(h.a)(j.a.mark((function e(t,n){var r,a,c,s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=f+t,a=b.stringify(Object(o.a)(Object(o.a)({},n),m)),e.next=4,fetch("".concat(r,"?").concat(a));case 4:return c=e.sent,e.next=7,c.json();case 7:return s=e.sent,e.abrupt("return",s);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var x=function(e){return Object(h.a)(j.a.mark((function t(){var n;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v("weather",{q:e});case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}}),t)})))()};var g={"01d":"\u2600\ufe0f","01n":"\u2600\ufe0f","02d":"\u26c5\ufe0f","02n":"\u26c5\ufe0f","03d":"\u2601\ufe0f","03n":"\u2601\ufe0f","04d":"\u2601\ufe0f","04n":"\u2601\ufe0f","09d":"\ud83c\udf27","09n":"\ud83c\udf27","10d":"\ud83c\udf26","10n":"\ud83c\udf26","11d":"\u26c8","11n":"\u26c8","13d":"\ud83c\udf28","13n":"\ud83c\udf28","50d":"\ud83c\udf2b","50n":"\ud83c\udf2b"},y=function(e){return e.toString().padStart(2,"0")},w=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"".concat(y(e.hours),":").concat(y(e.minutes)).concat(t.showSeconds?":".concat(y(e.seconds)):"").replace("25","01").replace("24","00")},I=n(58);n(80);function S(){var e=Object(d.a)(["\n  query GetStops($stopIds: [String], $numberOfDepartures: Int!) {\n    stops(ids: $stopIds) {\n      name\n      gtfsId\n      stoptimesWithoutPatterns(numberOfDepartures: $numberOfDepartures) {\n        stop {\n          id\n          gtfsId\n          platformCode\n          __typename\n        }\n        scheduledArrival\n        realtimeArrival\n        arrivalDelay\n        scheduledDeparture\n        realtimeDeparture\n        departureDelay\n        usedTime: realtimeDeparture\n        timepoint\n        realtime\n        realtimeState\n        pickupType\n        dropoffType\n        serviceDay\n        headsign\n        trip {\n          route {\n            shortName\n            __typename\n          }\n          __typename\n        }\n        __typename\n      }\n      __typename\n    }\n  }\n"]);return S=function(){return e},e}var D=Object(l.gql)(S()),N=function(){var e=Object(a.useState)(""),t=Object(u.a)(e,2),n=t[0],c=t[1],s=Object(a.useState)(""),i=Object(u.a)(s,2),d=i[0],p=i[1],j=Object(a.useState)(""),h=Object(u.a)(j,2),b=h[0],f=h[1],m=Object(a.useState)(0),v=Object(u.a)(m,2),O=v[0],y=v[1],S=Object(I.useDoubleTap)((function(){y(0===O?1:0)}));function N(){x("Tampere").then((function(e){var t=e.main.temp.toFixed(1);f(t),p(g[e.weather[0].icon])}))}Object(a.useEffect)((function(){N();var e=setInterval(N,6e5);return function(){return clearInterval(e)}}),[]);var _=function(){var e=(new Date).toLocaleTimeString("en-US",{hour12:!1});c(e)};Object(a.useEffect)((function(){var e=setInterval(_,500);return function(){return clearInterval(e)}}),[]);var k=Object(l.useQuery)(D,{variables:{stopIds:["tampere:4507","tampere:4511"],numberOfDepartures:10},pollInterval:6e4}),T=(k.loading,k.error,k.data),C=null===T||void 0===T?void 0:T.stops[O],A=null===C||void 0===C?void 0:C.stoptimesWithoutPatterns;return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)("header",{className:"header",children:[Object(r.jsxs)("div",{className:"weather",children:[Object(r.jsx)("div",{className:"icon",children:d}),Object(r.jsxs)("div",{className:"temperature ".concat(Number(b)>0?"positive":"negative"),children:[b,"\xb0C"]})]}),Object(r.jsx)("div",Object(o.a)(Object(o.a)({className:"stop"},S),{},{children:C.name})),Object(r.jsx)("div",{className:"time",children:n})]}),Object(r.jsxs)("table",{className:"bus",children:[Object(r.jsx)("thead",{children:Object(r.jsxs)("tr",{children:[Object(r.jsx)("th",{children:"Linja"}),Object(r.jsx)("th",{children:"L\xe4ht\xf6aika"})]})}),Object(r.jsx)("tbody",{children:null===A||void 0===A?void 0:A.map((function(e,t){return Object(r.jsxs)("tr",{children:[Object(r.jsx)("td",{children:e.trip.route.shortName}),Object(r.jsx)("td",{children:w((n=e.scheduledArrival,{hours:Math.floor(n/3600),minutes:Math.floor(n/60)%60,seconds:n%60}))})]},t);var n}))})]})]})},_=function(){return Object(r.jsx)("div",{className:"App",children:Object(r.jsx)(N,{})})},k=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,90)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),r(e),a(e),c(e),s(e)}))},T=new l.ApolloClient({uri:"https://api.digitransit.fi/routing/v1/routers/waltti/index/graphql",cache:new l.InMemoryCache});i.a.render(Object(r.jsx)(c.a.StrictMode,{children:Object(r.jsx)(l.ApolloProvider,{client:T,children:Object(r.jsx)(_,{})})}),document.getElementById("root")),k()}},[[89,1,2]]]);
//# sourceMappingURL=main.7bdbaa5f.chunk.js.map